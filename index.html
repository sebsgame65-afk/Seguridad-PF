<!DOCTYPE html> <!-- Define que el documento es HTML5 -->
<html>
<head>
  <meta charset="UTF-8"> <!-- Establece la codificaci贸n de caracteres como UTF-8 -->
  <title>Seguridad - Ubicaci贸n de Emergencia</title> <!-- T铆tulo que aparece en la pesta帽a del navegador -->
  <style>
    body {
      font-family: Arial, sans-serif; /* Tipo de fuente del texto */
      padding: 20px; /* Espaciado interno del cuerpo */
      background-color: #f2f2f2; /* Color de fondo claro */
      text-align: center;/*Alineacion de texto al centro/
    }
    #ubicacion {
      margin-top: 10px; /* Espacio superior */
      font-size: 18px; /* Tama帽o de fuente */
      color: #333; /* Color del texto */
    }
    #enlaceWhatsapp {
      display: none; /* Oculta el bot贸n hasta que se obtenga la ubicaci贸n */
      margin-top: 20px; /* Espacio superior */
      background-color: #25D366; /* Color verde de WhatsApp */
      color: white; /* Texto blanco */
      padding: 12px 20px; /* Espaciado interno del bot贸n */
      border-radius: 6px; /* Bordes redondeados */
      text-decoration: none; /* Quita el subrayado del enlace */
      font-weight: bold; /* Texto en negrita */
    }
  </style>
</head>
<body>
  <h2>Ubicaci贸n de Emergencia</h2> <!-- T铆tulo principal en la p谩gina -->
  <div id="ubicacion">Obteniendo ubicaci贸n...</div> <!-- Mensaje inicial mientras se obtiene la ubicaci贸n -->
  <a id="enlaceWhatsapp" href="#" target="_blank">Enviar ubicaci贸n por WhatsApp</a> <!-- Bot贸n oculto que se mostrar谩 luego -->

  <script>
    // Funci贸n que obtiene la ubicaci贸n del usuario
    function obtenerUbicacion() {
      if ("geolocation" in navigator) { // Verifica si el navegador soporta geolocalizaci贸n
        navigator.geolocation.getCurrentPosition(
          function(pos) { // Si se obtiene la ubicaci贸n correctamente
            var lat = pos.coords.latitude.toFixed(6); // Redondea la latitud a 6 decimales
            var lon = pos.coords.longitude.toFixed(6); // Redondea la longitud a 6 decimales

            // Muestra la latitud y longitud en pantalla
            document.getElementById("ubicacion").innerHTML =
              "Latitud: " + lat + "<br>Longitud: " + lon;

            // Crea el mensaje de alerta con enlace a Google Maps
            var mensaje = " Estoy en peligro. Mi ubicaci贸n es: https://www.google.com/maps?q=" + lat + "," + lon;

            var numero = "59164888073"; // N煤mero de destino en formato internacional (Bolivia)
            var enlace = "https://wa.me/" + numero + "?text=" + encodeURIComponent(mensaje); // Crea el enlace de WhatsApp con el mensaje

            var boton = document.getElementById("enlaceWhatsapp"); // Obtiene el bot贸n por su ID
            boton.href = enlace; // Asigna el enlace generado al bot贸n
            boton.style.display = "inline-block"; // Muestra el bot贸n en pantalla
          },
          function(error) { // Si ocurre un error al obtener la ubicaci贸n
            let mensaje = "";
            switch(error.code) {
              case error.PERMISSION_DENIED:
                mensaje = "Permiso de ubicaci贸n denegado."; // El usuario no permiti贸 acceso
                break;
              case error.POSITION_UNAVAILABLE:
                mensaje = "Ubicaci贸n no disponible."; // No se pudo obtener la ubicaci贸n
                break;
              case error.TIMEOUT:
                mensaje = "Tiempo de espera agotado."; // La solicitud tard贸 demasiado
                break;
              default:
                mensaje = "Error desconocido."; // Otro tipo de error
            }
            document.getElementById("ubicacion").innerHTML = mensaje; // Muestra el mensaje de error
          }
        );
      } else {
        // Si el navegador no soporta geolocalizaci贸n
        document.getElementById("ubicacion").innerHTML = "Tu navegador no soporta geolocalizaci贸n.";
      }
    }

    // Ejecuta la funci贸n cuando la p谩gina termina de cargar
    document.addEventListener("DOMContentLoaded", obtenerUbicacion);
  </script>
</body>

</html>
